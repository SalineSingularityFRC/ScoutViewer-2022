<html>
  <script src="Chart.js"></script>

  <body>
      <head>
        <link rel="stylesheet" type="text/css" href="style.css">
      </head>
      <div class="stform"> 
       
            <input type="text" id="teamData" name="teamData" placeholder="Enter team name">
            <button id="btn" onclick="tdata(teamData.value)">Submit</button>
      </div>
      <form>
        <input type="submit" value="Clear">
      </form>
      <div id="teamDataSet"></div>
      <div class="charts">
        <canvas id="chart">
        <script  type="module" src="js/script-work-pls.js"></script>
        </canvas>
      </div>

      <div class = "text">
        <h3>Saline Singularity Superior Scouting System See-er Service</h3>
        <p>The SSSSSSS (should sound like a dying snake when pronounced properly) is a service provided by First Robotics Challenge team number 5066 "Singularity" from Saline MI. It is a viewer or "see-er" that allows the user to view scouting data collected in the stands by our team. This information is available to anyone patient enough and shows the average points scored by each team and where they score the most points. You can disable any of these subcategories if you only want to look at who the best team is at a smaller selection of point scoring opportunities. This is done by simply clicking on said item at the top of the screen in the key. Hovering your mouse over any of the data will cause it to display its value as a decimal.</p>
      </div>
    </body>
    <script>
      
      function tdata(teamValue){
        fetch("../js/final.json").then(async (resp) => {
          const autoLowerHubScore = 2;
          const autoUpperHubScore = 4;
          const teleLowerHubScore = 1;
          const teleUpperHubScore = 2;
          const hangerScore = [0, 4, 6, 10, 15]
          const taxiScore = 2;

            let response = await resp.json();
            //ARRAYS DECLARED & INITALIZED
            let labelsArray = []
            let autoLowerHubArray = []
            let autoUpperHubArray = []
            let teleLowerHubArray = []
            let teleUpperHubArray = [];
            let hangerArray = []
            let taxiArray = []
            
            let teamNum = 0;
            let autoLowerHub = 1;
            let autoUpperHub = 2;
            let teleLowerHub = 3;
            let teleUpperHub = 4;
            let hanger = 5;
            let taxi = 6;
            let counter = 7;
            let matchnum = 8;
            //LABEL FOR LOOP
            var counterArray = [];
            let finalnum = 0;
        
            let arrayHangerPercent = [];
           
            for(var i = 0; i < response.length; i++){
              if(response[i][1][teamNum] == teamValue){
              arrayHangerPercent.push(response[i][1][hanger])  
            }
          }
            let matchCount = arrayHangerPercent.length;
            console.log(arrayHangerPercent)
            let finalteamdata = [];
            let hanger0 = 0;
            let hanger1 = 0;
            let hanger2 = 0;
            let hanger3 = 0;
            let hanger4 = 0;
            if(arrayHangerPercent.length > 0){

            for(var i = 0; i<matchCount-1; i++){
                if(arrayHangerPercent[i] == 4) hanger4++;
                else if(arrayHangerPercent[i] == 3) hanger3++;
                else if(arrayHangerPercent[i] ==2 ) hanger2++
                else if(arrayHangerPercent[i] == 1) hanger1++
                else hanger0++;
            }
            document.getElementById("teamDataSet").innerHTML = " ";
            document.getElementById("teamDataSet").innerHTML += "<br>Team #: " + response[i][1][teamNum] + " |  Total Competition Hanger Percentage <br> ";
            document.getElementById("teamDataSet").innerHTML += "Hanger (Percent) None (#0): "  + (hanger0 / matchCount) * 100 + "%<br>"
            document.getElementById("teamDataSet").innerHTML += "Hanger (Percent) Low (#1): " + (hanger1 / matchCount) * 100 + "%<br>"
            document.getElementById("teamDataSet").innerHTML += "Hanger (Percent) Mid (#2): " + (hanger2 / matchCount) * 100 + "%<br>"
            document.getElementById("teamDataSet").innerHTML += "Hanger (Percent) High (#3): " + (hanger3 / matchCount) * 100 + "%<br>"
            document.getElementById("teamDataSet").innerHTML += "Hanger (Percent) Traversal (#4): " + (hanger4 / matchCount) * 100 + "%<br><br><br>"
          } else {
            document.getElementById("teamDataSet").innerHTML = "No Teams Found"
       
          }
            for(var i = 0; i < response.length; i++){
              //LabelArray
              if(response[i][1][teamNum] == teamValue){ 
                document.getElementById("teamDataSet").innerHTML += "Match Num: " + response[i][1][matchnum] + " | Team Number: " + response[i][1][teamNum] + "<br>" + "autoLowerHub: " + response[i][1][autoLowerHub] + "<br>" + "autoUpperHub: " + response[i][1][autoUpperHub] + "<br>" + "teleLowerHub: " + response[i][1][teleLowerHub] + "<br>" + "teleUpperHub: " + response[i][1][teleUpperHub] + "<br>" + "taxi (Rungs): " + response[i][1][taxi] + "<br>" + "hanger: " + response[i][1][hanger] + "<br>" + "<br>"
              }

            for(var j = 0; j < labelsArray.length; j++){
              if(labelsArray[j] == response[i][1][teamNum]){
                response[i][1][autoLowerHub] += autoLowerHubArray[j];
                response[i][1][autoUpperHub] += autoUpperHubArray[j]
                response[i][1][teleLowerHub] += teleLowerHubArray[j]
                response[i][1][teleUpperHub] += teleUpperHubArray[j]  
                response[i][1][hanger] =  hangerScore[response[i][1][hanger]] + hangerArray[j];
                response[i][1][taxi] += taxiArray[j];
                response[i][1][counter] += counterArray[j];
            
                
                autoLowerHubArray.splice(j,1)
                autoUpperHubArray.splice(j,1)
                teleLowerHubArray.splice(j,1)
                teleUpperHubArray.splice(j,1)
                counterArray.splice(j,1)
                hangerArray.splice(j,1)
                taxiArray.splice(j,1)
                labelsArray.splice(j,1);
            } 
            }
                labelsArray.push(response[i][1][teamNum]) 
                //autoLowerHubArray
                autoLowerHubArray.push(response[i][1][autoLowerHub])
                
                //autoUpperHub
                autoUpperHubArray.push(response[i][1][autoUpperHub])
                
                //teleLowerHubArray
                
                teleLowerHubArray.push(response[i][1][teleLowerHub])
                
                //teleUpperHubArray
                
                teleUpperHubArray.push(response[i][1][teleUpperHub])
                
                //hangerArray
                hangerArray.push(response[i][1][hanger])
            
                taxiArray.push(response[i][1][taxi])
            
                counterArray.push(response[i][1][counter])
                
            }
      })
    }
  
    </script>
</html>